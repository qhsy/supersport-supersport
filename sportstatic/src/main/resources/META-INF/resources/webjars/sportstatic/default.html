<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>详情</title>
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta name="format-detection" content="telephone=no">
<meta name="format-detection" content="email=no" >
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="author" content="">
<link rel="stylesheet" href="css/main.css?version=20160509">
<link rel="stylesheet" type="text/css" href="css/index-min.css">
<script src="script/prism-min.js"></script>
</head>
<body class="ms-controller" >
<section class="details-author">
	<div class="details-photo" onclick="callbackFunc()"></div>
	<h2 class="details-name"></h2>
</section>
<div class="details-hgroup">
	<h1></h1>
	<time></time>
</div>
<article class="details-article"></article>
<aside class="details-tag"><b></b><span></span><b></b></aside>
<script type="text/javascript" src="script/zepto.min.js"></script>

<script type="text/javascript">
	$(function(){
		var code = getCode(window.location.search);
		$.ajax({
			url:'/api/contentController/contentDetail',
			type:'POST',
			contentType:'application/json',
			data:'{"content_code":"' + code + '",	"zoo": {"key": "tesetkey","token": "12221"}}',
			dataType:'json',
			success:function(data){
				if(data.contentRecommInfo != null){
					if(data.contentRecommInfo.content != ''){
						var ele = $('<fieldset class="details-basten"><legend>果果推荐语</legend><p></p></fieldset>');
							ele.prependTo('body');
							ele.find('p').html(data.contentRecommInfo.content);
					}
				}
				
				$('.head').attr('src',data.sportingMoment.cover)
				$('.details-hgroup h1').html(data.sportingMoment.title);
				$('.details-hgroup time').html(data.sportingMoment.publishTime);
				$('.details-photo').html('<img src="' + data.sportingMoment.aboutHead + '" />')
				$('.details-name').html(data.sportingMoment.nickName);
				$('.details-article').html(data.contentDetailInfo.content);
				$('.details-tag span').html(data.sportingMoment.tagCode)
				$('body').removeClass('ms-controller');
				if(data.sportingMoment.contentType == '02'){
					InitPlayer(data.contentDetailInfo.videoUrl, data.contentDetailInfo.videoCover);
				}
			},
			error:function(xhr,status,error){
					alert(error);
			}
		});
	});

	/* 通过URL获取CODE值 */
	function getCode(str){
		// ?content_code=string
		if(typeof str != 'string') return;
		var arr = str.substr(1).split('=');
		return arr[1];
	}
	function callbackFunc(){
		var userAgent = navigator.userAgent;
		if(userAgent.indexOf('Android') != -1){
			javascript:android.StartUserInfo();
		}
	}
	
	function InitPlayer(videoUrl, coverUrl){
		var player = new prismplayer({
		    id: "prismPlayer", // 容器id
		    source: videoUrl,        // 视频url 支持互联网可直接访问的视频地址
		    autoplay: false,      // 自动播放
		    width: "100%",       // 播放器宽度
		    height: "400px",      // 播放器高度
		    trackLog: false,
		    cover: coverUrl,
		    skinLayout: [
		        {
		            "align":"blabs",
		            "x":0,
		            "y":0,
		            "name":"controlBar",
		            "children":[
		                {
		                    "align":"tlabs",
		                    "x":0,
		                    "y":0,
		                    "name":"progress"
		                },{
		                    "align":"tl",
		                    "x":15,
		                    "y":26,
		                    "name":"playButton"
		                },{
		                    "align":"tl",
		                    "x":10,
		                    "y":24,
		                    "name":"timeDisplay"
		                },{
		                    "align":"tr",
		                    "x":20,
		                    "y":25,
		                    "name":"fullScreenButton"
		                },{
		                    "align":"tr",
		                    "x":20,
		                    "y":25,
		                    "name":"volume"
		                }
		            ]
		        }
		    ]
		});
	}
	
</script>
</body>
</html>